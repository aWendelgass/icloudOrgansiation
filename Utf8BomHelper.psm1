function Export-CsvWithBom {    param (        [Parameter(Mandatory = $true)]        [object]$Data,        [Parameter(Mandatory = $true)]        [string]$Path,        [string]$Delimiter = ';',        [switch]$Append    )    $tempPath = "$Path.tmp"    # Schreibe temporär ohne BOM    $Data | Export-Csv -Path $tempPath -NoTypeInformation -Delimiter $Delimiter -Encoding UTF8    if (-not (Test-Path $Path) -or -not $Append) {        # Datei existiert nicht oder kein Append → BOM hinzufügen        $utf8Bom = [System.Text.Encoding]::UTF8.GetPreamble()        $content = Get-Content -Path $tempPath -Raw        [System.IO.File]::WriteAllBytes($Path, $utf8Bom + [System.Text.Encoding]::UTF8.GetBytes($content))    } else {        # Datei existiert und Append → Inhalt ohne BOM anhängen        $content = Get-Content -Path $tempPath -Raw        Add-Content -Path $Path -Value $content -Encoding UTF8    }    Remove-Item -Path $tempPath -Force}